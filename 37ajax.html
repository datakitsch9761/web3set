<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf8">
    <title>ajax</title>
</head>
<body>
    <h1>Ajax</h1>
    <p>Ajax 통신결과 <span id = "msg"></span> </p>
    <div>
    <button type="button" id='saybtn'>인사말하기</button>
    </div>

    <script>
        let saybtn = document.getElementById('saybtn');
        let msg = document.getElementById('msg');
        saybtn.addEventListener('click', sayHello);

        function sayHello(){
            //1.XMLHttpRequest 객체 초기화
            //2.서버에 비동기 요청 보냄
            //3.서버에서 응답이 오면  나머지 처리

            //1.
            let req = new XMLHttpRequest();

            //3.서버의 응답에 따라 처리할 절차를 콜백함수로 정의함
            // readystatechange : 서버에서의 응답여부 확인 이벤트 속성

                // readystate : 서버응답 속성
                // 0 : 초기화되지 않음
                // 1 : 서버와 연결성공
                // 2 : 서버와 요청수락
                // 3 : 서버가 요청처리중
                // 4 : 서버가 요청처리완료 & 곧 응답예정

                // status : HTTP 상태코드 - 요청 성공 여부 확인
                // 200 : 처리완료, 응답 잘 받음
                // 404 : 처리실패, 요청데이터가 존재하지 않음
                // 500 : 처리실패, 서버상 코드의 오류
            req.onreadystatechange = function(){
                console.log(req.readyState);
                if(req.readyState == 4){
                    if(req.status == 200)
                        msg.innerHTML = req.responseText;
                    else
                        msg.innerHTML = req.status;
                } else
                    msg.innerHTML = req.readyState;
            };

            //2.비동기 요청을 생성하고 서버로 보냄
            //open(요청방식, url, 비동기 여부)
            req.open('get','hello1.txt', true);
            req.send();
        }
    </script>
</body>
</html>
<!--
Ajax
Asynchronous Javascript and XML
HTTP 프로토콜을 이용해서 비동기 방식으로 데이ㅓ를 주고 받는 기법을 의미

HTTP 프로토콜은 기본적으로 동기방식의 데이터 교환만을 지원했었는데
1993년 MS의 Microsoft.XMLHTTP 라는 컴퍼넌트 덕택으로
비동기 처리기술이 활성화됨
2000년 12월, FF가 XMLHttpRequest라는 이름으로 지원
그 이후 2004년 4월, CR이 구글맵으로 통해 Ajax기술 지원
-->

<!--
동기 vs 비동기
동기 : 모든 작업은 개별 작업의 처리시간에 맞춰 실행되는 방식
    FIFO : 먼저 요청된 작업이 처리됨
    앞서 처리 중인 작업의 처리시간이 길어지면
    나머지 작업들은 하염없이 가다려야 함
    ex)명절 기차표 예매, 은행 송금

비동기 : 모든 작업은 개별작업의 처리시간에 상관없이 다발적으로 실행되는 방식
    LIFO : 먼저 요청한 작업이 먼저 끝난다고 보장할 수 없음
    앞서 처리 중인 작업의 처리시간이 길어지면
    다른 작업을 우선적으로 처리할 수 있음
    ex) 마트 물건 계산
-->

<!--
https://developer.mozilla.org/ko/docs/Web/Guide/AJAX/Getting_Started
-->
